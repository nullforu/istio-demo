# HTTPRoute - 가중치 기반 라우팅 (Canary)
#
# 설명:
#   - weight로 트래픽 분배
#   - 80% → v1, 20% → v2
#
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: backend-canary-route
  namespace: istio-demo
spec:
  parentRefs:
    - name: demo-gateway
  hostnames:
    - "backend.local"
  rules:
    - backendRefs:
        - name: backend-v1
          port: 8080
          weight: 80
        - name: backend-v2
          port: 8080
          weight: 20
